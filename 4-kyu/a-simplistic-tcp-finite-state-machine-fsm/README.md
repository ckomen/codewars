<h2><a href=https://www.codewars.com/kata/54acc128329e634e9a000362/train/python target="_blank">A Simplistic TCP Finite State Machine (FSM)</a></h2><h3>4 kyu</h3><p>Automatons, or Finite State Machines (FSM), are extremely useful to programmers when it comes to software design. You will be given a simplistic version of an FSM to code for a basic TCP session.</p><p>The outcome of this exercise will be to return the correct state of the TCP FSM based on the array of events given.</p><hr><p>The input array of events will consist of one or more of the following strings:</p><pre><code>APP_PASSIVE_OPEN, APP_ACTIVE_OPEN, APP_SEND, APP_CLOSE, APP_TIMEOUT, RCV_SYN, RCV_ACK, RCV_SYN_ACK, RCV_FIN, RCV_FIN_ACK</code></pre><hr><p>The states are as follows and should be returned in all capital letters as shown:</p><pre><code>CLOSED, LISTEN, SYN_SENT, SYN_RCVD, ESTABLISHED, CLOSE_WAIT, LAST_ACK, FIN_WAIT_1, FIN_WAIT_2, CLOSING, TIME_WAIT</code></pre><hr><p>The input will be an array of events. The initial state is <code>CLOSED</code>. Your job is to traverse the FSM as determined by the events, and return the proper final state as shown above.</p><p>If an event is not applicable to the current state, your code will return <code>"ERROR"</code>.</p><h3 id="action-of-each-event-upon-each-state">Action of each event upon each state:</h3><p>(the format is <code>INITIAL_STATE: EVENT -&gt; NEW_STATE</code>)</p><pre><code>CLOSED: APP_PASSIVE_OPEN -&gt; LISTENCLOSED: APP_ACTIVE_OPEN  -&gt; SYN_SENTLISTEN: RCV_SYN          -&gt; SYN_RCVDLISTEN: APP_SEND         -&gt; SYN_SENTLISTEN: APP_CLOSE        -&gt; CLOSEDSYN_RCVD: APP_CLOSE      -&gt; FIN_WAIT_1SYN_RCVD: RCV_ACK        -&gt; ESTABLISHEDSYN_SENT: RCV_SYN        -&gt; SYN_RCVDSYN_SENT: RCV_SYN_ACK    -&gt; ESTABLISHEDSYN_SENT: APP_CLOSE      -&gt; CLOSEDESTABLISHED: APP_CLOSE   -&gt; FIN_WAIT_1ESTABLISHED: RCV_FIN     -&gt; CLOSE_WAITFIN_WAIT_1: RCV_FIN      -&gt; CLOSINGFIN_WAIT_1: RCV_FIN_ACK  -&gt; TIME_WAITFIN_WAIT_1: RCV_ACK      -&gt; FIN_WAIT_2CLOSING: RCV_ACK         -&gt; TIME_WAITFIN_WAIT_2: RCV_FIN      -&gt; TIME_WAITTIME_WAIT: APP_TIMEOUT   -&gt; CLOSEDCLOSE_WAIT: APP_CLOSE    -&gt; LAST_ACKLAST_ACK: RCV_ACK        -&gt; CLOSED</code></pre><figure><svg viewBox="0 0 1084 817" xmlns="http://www.w3.org/2000/svg" style="background-color: grey"><path d="M692 451h298v281H692zm-604 1h566v281H88z" stroke-linecap="round" stroke-dasharray="6 6" stroke="#000" fill="#cdffff"></path><path d="M463 123h136v30H463z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><path d="M449 306h164v30H449z" stroke-linecap="round" stroke="#000" fill="#00f900"></path><path d="M463 49h136v30H463z" stroke-linecap="round" stroke="#000" fill="#fe6500"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="194" x="329" xml:space="preserve"><tspan y="194" x="329">CLOSED</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="192" x="247" xml:space="preserve"><tspan y="192" x="247">(Start)</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="222" x="261" xml:space="preserve"><tspan y="222" x="261">LISTEN/-</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="236" x="409" xml:space="preserve"><tspan y="236" x="409">CLOSE/-</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="268" x="334" xml:space="preserve"><tspan y="268" x="334">LISTEN</tspan></text><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M498 83v36h1V83z"></path><path d="m498 109-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M565 87h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m565 94 4 4-4-14-4 14z" stroke-width="1.1"></path></g><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M198 138v57h1v-56h261v-1z"></path><path d="m199 185-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M497 157h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm-222 2h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m497 167 4 4-4-14-4 14z" stroke-width="1.1"></path></g><path d="M131 199h136v60H131z" stroke="#000" fill="silver"></path><text transform="translate(167 -124)" text-anchor="middle" style="text-align:center" font-weight="700" font-size="16.8" font-family="Arial" y="347" x="32" xml:space="preserve"><tspan y="347" x="32">SYN</tspan><tspan y="368" x="32">RECEIVED</tspan></text><g stroke="#000" fill-rule="evenodd"><path d="M564 157h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm2 2h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m757 214-4 4 14-4-14-4z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M275 244h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m282 244 4-4-14 4 14 4z" stroke-width="1.1"></path></g><path d="M771 199h136v60H771z" stroke="#000" fill="silver"></path><text transform="translate(167 -124)" text-anchor="middle" style="text-align:center" font-weight="700" font-size="16.8" font-family="Arial" y="347" x="672" xml:space="preserve"><tspan y="347" x="672">SYN</tspan><tspan y="368" x="672">SENT</tspan></text><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M603 56v1h269v138h1V56z"></path><path d="m873 185-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M605 71h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm1 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m615 71 4-4-14 4 14 4z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="173" x="468" xml:space="preserve"><tspan y="173" x="468">CONNECT/</tspan></text><text transform="translate(167 -124)" font-weight="400" font-style="italic" font-size="13.1" font-family="Courier New" y="172" x="585" xml:space="preserve"><tspan y="172" x="585">(Step 1 of the 3-way-handshake)</tspan></text><g stroke="#000" fill-rule="evenodd"><path d="M153 262h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m154 486-4-4 4 14 4-14z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="173" x="546" xml:space="preserve"><tspan y="173" x="546">SYN</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="257" x="116" xml:space="preserve"><tspan y="257" x="116">SYN/SYN+ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-style="italic" font-size="13.1" font-family="Courier New" y="256" x="-137" xml:space="preserve"><tspan y="256" x="-137">(Step 2 of the 3-way-handshake)</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.9" font-family="Arial" y="183" x="13" xml:space="preserve"><tspan y="183" x="13">unusual event</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.9" font-family="Arial" y="197" x="13" xml:space="preserve"><tspan y="197" x="13">client/receiver path</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.9" font-family="Arial" y="213" x="13" xml:space="preserve"><tspan y="213" x="13">server/sender path</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="13.1" font-family="Arial" y="332" x="206" xml:space="preserve"><tspan y="332" x="206">RST/-</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="13.9" font-family="Arial" y="363" x="234" xml:space="preserve"><tspan y="363" x="234">SYN/SYN+ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="13.1" font-family="Courier New" y="362" x="342" xml:space="preserve"><tspan y="362" x="342">(simultaneous open)</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="13.2" font-family="Arial" y="438" x="526" xml:space="preserve"><tspan y="438" x="526">SYN+ACK/ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-style="italic" font-size="13.1" font-family="Courier New" y="458" x="471" xml:space="preserve"><tspan y="458" x="471">(Step 3 of the 3-way-handshake)</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="17" font-family="Courier New" y="422" x="263" xml:space="preserve"><tspan y="422" x="263">Data exchange occurs</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="449" x="305" xml:space="preserve"><tspan y="449" x="305">ESTABLISHED</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.1" font-family="Arial" y="528" x="518" xml:space="preserve"><tspan y="528" x="518">FIN/ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.9" font-family="Arial" y="437" x="153" xml:space="preserve"><tspan y="437" x="153">ACK/-</tspan></text><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M88 70v1h82v-1z"></path><path d="m160 70-4 4 14-4-14-4z" stroke-width="1.1"></path></g><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M88 86v1h82v-1z"></path><path d="m160 86-4 4 14-4-14-4z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M88 57h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m160 56-4 4 14-4-14-4z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="700" font-size="13.1" font-family="Arial" y="211" x="517" xml:space="preserve"><tspan y="211" x="517">CLOSE/-</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="332" x="456" xml:space="preserve"><tspan y="332" x="456">SEND/</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="332" x="503" xml:space="preserve"><tspan y="332" x="503">SYN</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="501" x="-5" xml:space="preserve"><tspan y="501" x="-5">CLOSE/</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="501" x="52" xml:space="preserve"><tspan y="501" x="52">FIN</tspan></text><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="530" x="159" xml:space="preserve"><tspan y="530" x="159">CLOSE/</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="530" x="216" xml:space="preserve"><tspan y="530" x="216">FIN</tspan></text><path d="M463 501h136v30H463z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="646" x="326" xml:space="preserve"><tspan y="646" x="326">CLOSING</tspan></text><path d="M463 651h136v30H463z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="796" x="321" xml:space="preserve"><tspan y="796" x="321">TIME WAIT</tspan></text><path d="M463 757h136v30H463z" stroke-linecap="round" stroke="#000" fill="#fe6500"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="902" x="329" xml:space="preserve"><tspan y="902" x="329">CLOSED</tspan></text><path d="M131 501h136v30H131z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="646" x="-11" xml:space="preserve"><tspan y="646" x="-11">FIN WAIT 1</tspan></text><path d="M131 651h136v30H131z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="796" x="-12" xml:space="preserve"><tspan y="796" x="-12">FIN WAIT 2</tspan></text><path d="M773 501h136v30H773z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="646" x="622" xml:space="preserve"><tspan y="646" x="622">CLOSE WAIT</tspan></text><path d="M773 651h136v30H773z" stroke-linecap="round" stroke="#000" fill="#feff00"></path><text transform="translate(167 -124)" font-weight="700" font-size="16.8" font-family="Arial" y="796" x="631" xml:space="preserve"><tspan y="796" x="631">LAST ACK</tspan></text><path d="M692 451h139v29H692zm-177 1h139v29H515z" stroke-linecap="round" stroke="#000" fill="none"></path><text transform="translate(167 -124)" font-weight="700" font-size="14.8" font-family="Arial" y="712" x="679" xml:space="preserve"><tspan y="712" x="679">CLOSE/</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="14.8" font-family="Arial" y="712" x="736" xml:space="preserve"><tspan y="712" x="736">FIN</tspan></text><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M587 339v71h253v88h1v-89H588v-70z"></path><path d="m841 488-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M839 535v113h1V535z"></path><path d="m840 638-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M839 685v89H605v1h235v-90z"></path><path d="m614 774 4-4-14 4 14 4z" stroke-width="1.1"></path></g><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M476 341v68H244v89h1v-88h232v-69z"></path><path d="m244 488-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M271 509h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0v-1z" stroke-dasharray="1 3"></path><path d="m449 509-4 4 14-4-14-4z" stroke-width="1.1"></path></g><g stroke="#000" fill-rule="evenodd"><path d="M271 525h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm1 3h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 3v1h1v-1zm4 1h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1zm4 0h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m449 659-4 4 14-4-14-4z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="625" x="166" xml:space="preserve"><tspan y="625" x="166">FIN/ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="668" x="109" xml:space="preserve"><tspan y="668" x="109">FIN+ACK/ACK</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="711" x="-10" xml:space="preserve"><tspan y="711" x="-10">ACK/-</tspan></text><g stroke="#000" fill-rule="evenodd"><path d="M531 536h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1zm0 4h1v-1h-1z" stroke-dasharray="1 3"></path><path d="m532 638-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M198 536v112h1V536z"></path><path d="m199 638-4-4 4 14 4-14z" stroke-width="1.1"></path></g><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M271 673v1h187v-1z"></path><path d="m448 674-4 4 14-4-14-4z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="814" x="166" xml:space="preserve"><tspan y="814" x="166">FIN/ACK</tspan></text><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M531 685v70h1v-70z"></path><path d="m531 745-4-4 4 14 4-14z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="400" font-size="14.1" font-family="Arial" y="841" x="369" xml:space="preserve"><tspan y="841" x="369">Timeout</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="17" font-family="Courier New" y="901" x="110" xml:space="preserve"><tspan y="901" x="110">(Go back to start)</tspan></text><g stroke="brown" fill-rule="evenodd" fill="brown"><path d="M839 263v56H619v1h221v-57z"></path><path d="m629 320 4-4-14 4 14 4z" stroke-width="1.1"></path></g><g stroke="#0001f6" fill-rule="evenodd" fill="#0001f6"><path d="M243 263v58h201v-1H244v-57z"></path><path d="m434 320-4 4 14-4-14-4z" stroke-width="1.1"></path></g><text transform="translate(167 -124)" font-weight="400" font-size="17" font-family="Courier New" y="594" x="362" xml:space="preserve"><tspan y="594" x="362">Active CLOSE</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="17" font-family="Courier New" y="593" x="529" xml:space="preserve"><tspan y="593" x="529">Passive CLOSE</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="718" x="371" xml:space="preserve"><tspan y="718" x="371">ACK/-</tspan></text><text transform="translate(167 -124)" font-weight="400" font-size="12.8" font-family="Arial" y="835" x="682" xml:space="preserve"><tspan y="835" x="682">ACK/-</tspan></text></svg>  <figcaption>TCP state diagram, originally from <a href="https://commons.wikimedia.org/wiki/File:Tcp_state_diagram_fixed_new.svg" data-turbolinks="false" target="_blank">wikimedia commons</a>.</figcaption></figure><h2 id="examples">Examples</h2><pre><code>["APP_PASSIVE_OPEN", "APP_SEND", "RCV_SYN_ACK"] =&gt;  "ESTABLISHED"["APP_ACTIVE_OPEN"] =&gt;  "SYN_SENT"["APP_ACTIVE_OPEN", "RCV_SYN_ACK", "APP_CLOSE", "RCV_FIN_ACK", "RCV_ACK"] =&gt;  "ERROR"</code></pre><p>This kata is similar to <a href="https://www.codewars.com/kata/design-a-simple-automaton-finite-state-machine" data-turbolinks="false" target="_blank">Design a Simple Automaton (Finite State Machine)</a>, and you may wish to try that kata before tackling this one.</p><p>See wikipedia page <a href="http://en.wikipedia.org/wiki/Transmission_Control_Protocol" data-turbolinks="false" target="_blank">Transmission Control Protocol</a>for further details.</p><p>See <a href="http://www.medianet.kent.edu/techreports/TR2005-07-22-tcp-EFSM.pdf" data-turbolinks="false" target="_blank">http://www.medianet.kent.edu/techreports/TR2005-07-22-tcp-EFSM.pdf</a> page 4, for the FSM diagram used for this kata.</p>